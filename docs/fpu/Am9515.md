# Am9515 (P4) - Matrix/Tensor Tier

This document summarizes the Project Carbon **Am9515 P4** personality implemented
inside the shared Am95xx accelerator.

## Status and identity

- Presented tier: **P4 (Am9515)**.
- Feature bit: `AM9515_TENSOR`.
- Enabled via CAI per-descriptor mode override or CSR default mode.

## Tensor descriptor model (v1)

The tensor path uses the CAI tensor descriptor v1:

- `rank` (up to 4), `elem_format`, `shape0..shape3`, `stride0..stride3`.
- For GEMM:
  - `shape0 = M`, `shape1 = N`, `shape2 = K`.
  - `stride0/1/2` apply to A/B/C, defaulting to contiguous when zero.
- For DOT/SUM:
  - `shape0 = length`, `stride0/1` apply to input vectors.
- `result_stride` defaults to `stride_c * elem_bytes` when zero.

## Implemented operations (v1)

- `GEMM` (C = A * B + C)
- `DOT`
- `SUM` (reduction over a single axis)

## Numeric policy and determinism

- FP16/BF16 inputs are accumulated in **FP32**.
- FP32 inputs accumulate in FP32.
- Execution order is deterministic (nested loop order in descriptor order).
- No nondeterministic parallel reductions are permitted.

## Deferred / TODO

- Higher-rank tensor contractions beyond v1 mapping.
- Tile/blocked optimizations and explicit cache controls.
- Alternate accumulation precision (FP64) or mixed-precision epilogues.
